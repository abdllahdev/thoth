model User {
	id        Int     @id
	firstName String
	lastName  String
}

model Task {
	id        Int      @id
	title     String
	isDone    Boolean  @default(false)
	createdAt DateTime @default(now)
	updatedAt DateTime @updatedAt
}

query getTasks(filter: { title, isDone }) : findMany
@on(Task)
@permission(isAuth)

query createTask(data: { title }) : create
@on(Task)
@permission(isAuth)

query getTaskById(where: id) : findUnique
@on(Task)
@permission(isAuth)

query updateTaskById(where: id, data: { title, isDone }) : update
@on(Task)
@permission(isAuth, owns)

query deleteTaskById(where: id) : delete
@on(Task)
@permission(isAuth, owns)

component TaskView(task) {
	render("
		<div className='text-blue-500 pb-2 divide-black'>
			Title: { task.title }
			<div className='divide-y-2'></div>
			Is Done: { task.isDone ? 'YES' : 'NO' }
			<div className='divide-y-2 divide-black'></div>
			Created At: { task.createdAt }
		</div>
	")
}

page Home @on("/") {
	let tasks = getTasks()

	render("
		tasks.map((task) => <TaskView key={task.id} task={task} />)
	")
}
