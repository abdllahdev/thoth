model User {
	id        Int     @id
	firstName String
	lastName  String
	tasks     Task[]
}

model Task {
	id        Int      @id
	title     String
	isDone    Boolean  @default(false)
	user      User     @relation(userId, id)
	userId    Int
	createdAt DateTime @default(now)
	updatedAt DateTime @updatedAt
}

query getTasks(filter: { title, isDone }) : findMany
@on(Task)
@permission(isAuth)

query createTask(data: { title }) : create
@on(Task)
@permission(isAuth)

query getTaskById(where: id) : findUnique
@on(Task)
@permission(isAuth)

query updateTaskById(where: id, data: { title, isDone }) : update
@on(Task)
@permission(isAuth, owns)

query deleteTaskById(where: id) : delete
@on(Task)
@permission(isAuth, owns)

component TaskView(task) {
	render("
		<div>
			{task.id}
			{task.updatedAt}
		</div>
	")
}

component Home @on("/") {
	let tasks = getTasks()

	render("
		{tasks.map((task) => <Task key={task.id} id={task.id} />)}
	")
}
