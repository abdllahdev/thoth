{% if type == "login" or type == "signup" %}
import { useNavigate } from "react-router";
import { useEffect, useState } from "react";
import { User } from "@/types";
{% endif %}
{% if requires_auth %}
import { useState } from "react";
import { User } from "@/types";
{% endif %}
import Form from "@/ui/Form";

const baseUrl = "http://localhost:4000";

const {{ id }} = () => {
  const url = `${baseUrl}/{{ post_to }}`;

  {% if requires_auth %}
  const storedUser = localStorage.getItem("user");
  const [user, _] = useState<User | undefined>(
    storedUser ? (JSON.parse(storedUser) as User) : undefined
  );
  {% endif %}

  {% if type == "login" or type == "signup" %}
  const navigate = useNavigate();
  const storedUser = localStorage.getItem("user")
    ? JSON.parse(localStorage.getItem("user") as string)
    : undefined;
  const [user, setUser] = useState<User | undefined>(storedUser);

  const handleResponse = async (response: User) => {
    localStorage.setItem("user", JSON.stringify(response));
    const storedUser = localStorage.getItem("user") as string;
    setUser(JSON.parse(storedUser) as User);
  };

  useEffect(() => {
    if (user) {
      navigate("{{ on_success_redirect_to }}");
    }
  }, [user]);
  {% endif %}

  return (
    <>
      <Form
        method={% if type == "create" or type == "signup" or type == "login" %}"POST"{% else %}"PUT"{% endif %}
        url={url}
        {% if style %}style="{{ style }}"{% endif %}
        {% if type == "login" or type == "signup" %}handleResponse={handleResponse}{% endif %}
        {% if requires_auth %}accessToken={user?.accessToken}{% endif %}
        formElements={[
          {% for input in form_inputs %}
            {
              {% if input.wrapper_style %}
              style: "{{ input.wrapper_style }}",
              {% endif %}

              {% if input.label_attrs %}
              formInputLabel: {
                {% for attr in input.label_attrs %}
                  {{ attr.name }}: "{{ attr.value }}",
                {% endfor %}
              },
              {% endif %}

              formInput: {
                {% for attr in input.input_attrs %}
                  {% if attr.name == "defaultValue" or attr.name == "visibility" %}
                  {{ attr.name }}: {{ attr.value }},
                  {% else %}
                  {{ attr.name }}: "{{ attr.value }}",
                  {% endif %}
                {% endfor %}
              }
            },
          {% endfor %}
        ]}
        formButton={{ "{{" }}
          {% for attr in form_button %}
            {{ attr.name }}: "{{ attr.value }}",
          {% endfor %}
        {{ "}}" }}
      />
    </>
  );
};

export default {{ id }};
